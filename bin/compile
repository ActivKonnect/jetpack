#!/bin/bash
# vim: fileencoding=utf-8 tw=100 noexpandtab ts=8 sw=8 ft=sh :

JETPACK_ROOT="$( cd "$( dirname "${BASH_SOURCE[0]}" )"/.. && pwd )"
. "$JETPACK_ROOT/init.sh"

BUILD_DIR="$1"
CACHE_DIR="$2"
APP_DIR="/app"

shout "Environment info"

echo "JETPACK_ROOT = $JETPACK_ROOT" | indent
echo "BUILD_DIR = $BUILD_DIR" | indent
echo "CACHE_DIR = $CACHE_DIR" | indent


shout "Preparing build"

echo "Fetching the app"
cp_contents "$BUILD_DIR" "$APP_DIR"


source "$BUILD_DIR/jetpack.sh"


echo "Saving the build"
cp_contents "$APP_DIR" "$BUILD_DIR"
